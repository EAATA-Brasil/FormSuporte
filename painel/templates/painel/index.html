{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EAATA – Painel</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/modern-normalize/modern-normalize.css" />
  <style>
    :root{
      --primary:#0B66C3; --primary-600:#0a59ac; --text:#0f172a; --muted:#64748b; --bg1:#f6f8fb; --bg2:#eef3f9; --panel:#ffffff; --stroke:#e5e7eb; --error:#ef4444;
    }
    body{ margin:0; color:var(--text); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans; background: linear-gradient(180deg,var(--bg1),var(--bg2)); min-height:100vh; }
    .wrap{ max-width: 1100px; margin: 54px auto; padding: 0 24px; }
    .brand{ display:flex; align-items:center; justify-content:space-between; margin-bottom:28px; }
    .brand-left{ display:flex; align-items:center; gap:14px; }
    .logo{ width:46px; height:46px; border-radius:12px; background: radial-gradient(100% 100% at 100% 0%, #2a6ae9 0%, #1246a5 100%); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:800; box-shadow: 0 10px 30px var(--glow); }
    h1{ margin:0; font-size: 26px; letter-spacing:.2px; }
    .subtitle{ color:var(--muted); font-size: 14px; }
    .logout{ text-decoration:none; display:inline-flex; align-items:center; gap:8px; background:#1f2937; color:#fff; border:1px solid #2b3548; padding:10px 14px; border-radius:10px; }
    .logout:hover{ background:#232f45; }

    .panel{ background: rgba(16,24,40,.55); border:1px solid var(--stroke); border-radius:16px; padding: 18px; backdrop-filter: blur(8px); }
    .grid{ display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .card{ position:relative; display:flex; flex-direction:column; gap:8px; padding:18px; border-radius:14px; background:linear-gradient(180deg,#0f1b30 0%, #0c1627 100%); border:1px solid var(--stroke); color:#dbeafe; text-decoration:none; box-shadow: 0 6px 20px rgba(2,8,23,.35); transition:.2s transform,.2s box-shadow,.2s border-color; }
    .card:hover{ transform: translateY(-2px); box-shadow: 0 12px 30px rgba(2,8,23,.45); border-color:#335285; }
    .card-icon{ width:38px; height:38px; border-radius:10px; display:flex; align-items:center; justify-content:center; background:#102448; color:#8ab4ff; font-weight:700; }
    .card-title{ font-weight:700; letter-spacing:.2px; }
    .card-desc{ font-size:12px; color:#9fb0cc; }

    .login{ max-width: 420px; margin: 56px auto; padding: 24px; border-radius:16px; border:1px solid var(--stroke); background:var(--panel); box-shadow: 0 10px 30px rgba(2,8,23,.08); }
    .login h2{ margin: 0 0 10px; }
    .field{ margin: 12px 0; }
    .field label{ display:block; color:var(--muted); font-size:13px; margin-bottom:6px; }
    .field input{ width:100%; height:44px; padding:0 12px; border-radius:10px; border:1px solid var(--stroke); background:#fff; color:var(--text); }
    .btn{ display:inline-flex; align-items:center; justify-content:center; height:44px; border-radius:10px; padding:0 16px; font-weight:700; border:1px solid #2b3548; cursor:pointer; text-decoration:none; }
    .btn-primary{ background:linear-gradient(180deg,#2d6df7 0%, #1553cf 100%); color:#fff; border-color:#2563eb; box-shadow: 0 10px 18px rgba(37,99,235,.15); }
    .btn-primary:hover{ filter: brightness(.98); }
    .messages{ margin-top:10px; }
    .msg{ background:#b91c1c; color:#fff; padding:8px 10px; border-radius:10px; }
    .section-title{ margin:0 0 12px; font-weight:700; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <div class="brand-left">
        <img src="{% static 'icons/eaata-logo.png' %}" alt="EAATA" style="height:34px;" onerror="this.style.display='none'" />
        <div>
          <h1 style="color:#0b66c3;">EAATA – Painel Gerencial</h1>
          <div class="subtitle">Acesse rapidamente os sistemas</div>
        </div>
      </div>
      {% if request.user.is_authenticated %}
        <a class="logout" href="{% url 'painel_logout' %}">Sair</a>
      {% endif %}
    </div>

    {% if request.user.is_authenticated %}
      <div class="layout" style="display:grid; grid-template-columns: 240px 1fr; gap:18px;">
        <aside class="panel" style="height:max-content;">
          <div class="section-title" style="margin-bottom:8px;">Menu</div>
          <nav style="display:grid; gap:8px;">
            <a class="card" href="/">
              <div class="card-title">Painel</div>
              <div class="card-desc">Início</div>
            </a>
            <a class="card" href="{% url 'painel_change_password' %}">
              <div class="card-title">Alterar senha</div>
              <div class="card-desc">Configurações da conta</div>
            </a>
            {% if request.user.is_superuser %}
              <a class="card" href="/ocorrencia/criar_usuario/">
                <div class="card-title">Criar usuário</div>
                <div class="card-desc">Somente admin</div>
              </a>
              <a class="card" href="/admin/">
                <div class="card-title">Painel Admin</div>
                <div class="card-desc">Django Admin</div>
              </a>
            {% endif %}
          </nav>
        </aside>
        <main>
          <div class="panel" style="margin-bottom:18px;">
            <div class="section-title">Olá, {{ request.user.username }}</div>
            <div class="grid">
              {% for link in quick_links %}
                <a class="card" href="{{ link.href }}">
                  <div class="card-icon">{{ link.label|first }}</div>
                  <div class="card-title">{{ link.label }}</div>
                  <div class="card-desc">Abrir módulo</div>
                </a>
              {% endfor %}
            </div>
          </div>
        </main>
      </div>
    {% else %}
      <div class="login">
        <h2>Login</h2>
        <form method="post">
          {% csrf_token %}
          <div class="field">
            <label>Usuário</label>
            <input type="text" name="username" autocomplete="username" />
          </div>
          <div class="field">
            <label>Senha</label>
            <input type="password" name="password" autocomplete="current-password" />
          </div>
          <div class="field">
            <button class="btn btn-primary" type="submit">Entrar</button>
          </div>
          {% if messages %}
            <div class="messages">
              {% for m in messages %}
                <div class="msg">{{ m }}</div>
              {% endfor %}
            </div>
          {% endif %}
        </form>
      </div>
    {% endif %}
  </div>
</body>
</html>
